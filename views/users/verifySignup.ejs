<%- include('../layouts/header.ejs') %>

  <section class="vh-100 gradient-form d-flex justify-content-center align-items-center">
    <div class="container">
      <div class="row d-flex justify-content-center align-items-center h-100">
        <div class="col-xl-10">
          <div class="text-black">
            <div class="row g-0 d-flex justify-content-center align-items-center">
              <div class="col-lg-6">
                <div class="card-body p-md-5 mx-md-4 border "
                  style="background-color: #d0d0d0; ">
                  <div class="text-center">
                    <h4 class="mt-1 mb-5 pb-1" style="
                      font-family: 'EB Garamond', serif;
                      font-family: 'Tilt Warp', cursive;
                    ">
                      Verify Account
                    </h4>
                  </div>
                  <form action="/verifyOtp" method="post">
                    <div class="d-flex flex-row align-items-center mb-1 ">
                      <i class="fas fa-user fa-lg me-3 fa-fw"></i>
                      <div class="form-outline flex-fill mb-0">
                        <label for="otp" class="form-label">Enter OTP</label>
                        <input type="text" id="otp" class="form-control" name="otp" placeholder="Enter OTP" required />
                      </div>

                    </div>

                    <div class="col-md-12 form-group p_star ms-3 mt-4">
                      <label for="password" class="form-label">Enter Password</label>
                      <input type="password" class="form-control" id="password" name="password" value=""
                        placeholder="Password">
                    </div>
                    <div class="d-flex flex-row align-items-center mb-1">
                      <i class="fas fa-user fa-lg me-3 fa-fw"></i>
                      <div class="form-outline flex-fill mb-0"></div>
                    </div>
                    <% if(typeof msg !=='undefined' ){ %>

                      <p style="font-size: small; color: red;font-family: 'EB Garamond', serif;" class="ms-3">
                        <%= msg %>
                      </p>


                      <% } %>
                        <button type="submit" class="btn btn-success btn-block ms-3 mt-3">
                          Verify
                        </button>
                        <button type="button" id="resend-otp" class="btn btn-link btn-block mt-4">
                          Resend OTP
                        </button>
                  </form>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script>
    $(document).ready(() => {
      const resendOtpButton = $('#resend-otp');
      let countdown = 10;

      resendOtpButton.on('click', () => {
        resendOtpButton.prop('disabled', true);

        $.ajax({
          type: 'POST',
          url: '/resendOtp',
          success: () => {
            startCountdown();
          },
          error: (xhr, status, error) => {
            console.error(error);
          },
        });
      });

      function startCountdown() {
        const countdownInterval = setInterval(() => {
          if (countdown > 0) {
            countdown--;
            resendOtpButton.html(`Resend OTP (${countdown})`);
          } else {
            clearInterval(countdownInterval);
            resendOtpButton.html('Resend OTP');
            resendOtpButton.prop('disabled', false);
            countdown = 10;
          }
        }, 1000);
      }
    });
  </script>

  <%- include('../layouts/footer.ejs')%>